Recovering homozygous genotypes of reference allele

09/08/2008

Author: Zhengzheng Wan (zwan@bcm.edu)


Introduction

This module is to recover the homozygous genotypes of reference alleles for the sites, where no substitution with respect to the reference genomic sequence is found. The current approach considers a site as homozygote if more than five reads with only the reference allele mapped to the locus. This module is to facilitate not only the SNP site discovery, but also the genotype determination for specific samples. 

This is the idea of not only discovering the variation sites in a sample collection, but also calling the genotypes of both the known and novel variation sites in the collection.

Command 

ruby homo-genotype-recover.rb 

(Note: This module may take large amount of computing resource. For example, it takes 4G memory to run this module when we were processing a data set with 1M reads. Therefore, this module must be run on the machine with large ram

Usage information

After creating working directory and the five sub-directories—“input”, “output”, “par”, “references” and “consensus”—the required input files must be filled in to their corresponding sub-directories. Followings are the description on the usage of each sub-directory and the files contained. 

“input” directory 

The SNP list, which has been used to call SNPs, is required to be created under this directory.  

“consensus” directory

Files with a suffix “.Cov.target_base_cov” or “.Cov.reference_base_cov” are required to be saved under this directory. This required file can be generated by running “atlas-snp-coverage.rb”, which calculates the coverage on each site of the reference genome.  

“references” directory

Under this directory, the reference genome, which has been provided as one of the argument when running “atlas-mapper.rb”, must be provided. 

“par” directory 

The parameter file under par is required to be named as “refhomo.par”. The required format of the parameter list is shown as follows: 

input:	[SNP.list] (Note: the second column must be the same as SNP.list under “input”.)
	
consensus:	[prefix.Cov.target_base_cov] (Note: the second column has the same name as that saved under “consensus” directory.)

reference:	[reference] (Note: the second column must have the same name as that saved under “references” directory.)

For example, we assume the name of SNP list under “input” is “my.SNP.list”. The consensus file under “consensus” directory is named as “my.consensus.Cov.target_base_cov”, and the file under “references” directory is named as “my.reference”. Then, the refhomo.par under “par” directory should contain the following parameter list:

input:	my.SNP.list

consensus:	my.consensus.Cov.target_base_cov

reference:	my.reference

“output” directory

The output file of this module uses the same file name as SNP.list, followed by a suffix “.homo.ref”. For example, if the input file name is “my.SNP.list”, the output file name will be “my.SNP.list.homo.ref”. This output file contains four columns of information about the chromosome, coordination and number of coverage for each homozygous genotype of reference allele. Following is the format of the output file.

Chromosome	Coordination	Genotype	No_of_coverage

chr12   38827102        CC      6
